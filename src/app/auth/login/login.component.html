import { ApolloProvider } from '@apollo/client';
import { fireEvent, screen } from '@testing-library/react';
import React from 'react';
import { Brand } from '../../../models/brands';
import { render, waitFor } from '../../../test-utils/renderWithProviders';
import ContactUsSearch from './ContactUsSearch';

jest.mock('../../iagBrandStore');

const mockClient = jest.fn() as any;

const onClearResults = jest.fn();

const setNoSearchTermSectionVisible = jest.fn();

describe('ContactUsSearch page tests', () => {
  beforeEach(() => {
    render(
      <ApolloProvider client={mockClient}>
        <ContactUsSearch
          searchTerm="Payments"
          setNoResultSectionVisible={jest.fn()}
          setSearchTerm={jest.fn()}
          setData={jest.fn()}
          setresultSectionVisible={jest.fn()}
        />
      </ApolloProvider>,
      { brand: Brand.NRMA },
    );
  });
  test('ContactUsSearch content check', async () => {
    expect(screen.getByTestId('breadcrumbs-item-last')).toHaveTextContent('Contact us');
    expect(screen.getByText('How can we help?')).toBeInTheDocument();
    expect(screen.getByText('Search answers to frequently asked questions')).toBeInTheDocument();
    expect(screen.getByText('Search')).toBeInTheDocument();
    expect(screen.getByTestId('contact-us-search-btn')).toBeInTheDocument();
  });

  test('displays filtered questions when a matching search term is entered', () => {
    const input = screen.getByPlaceholderText(/Try \"Update my credit card details\"/);
    fireEvent.change(input, { target: { value: 'BPAY' } });
  });
});
